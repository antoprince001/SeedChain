# 0x9b1E4132a784e5854B4df1929D0F80531f6Ed227
# 21830849

import json
from web3 import Web3

# Set up web3 connection with Ganache
ganache_url = "http://127.0.0.1:8545"
infura_url = "wss://kovan.infura.io/ws/v3/16497e91567d468facb98a99c27db479"

#web3 = Web3(Web3.HTTPProvider(infura_url))
web3 = Web3(Web3.WebsocketProvider(infura_url))

abi=json.loads('[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"CertificateNo","type":"string"},{"indexed":false,"internalType":"string","name":"CerticateDate","type":"string"}],"name":"seedCertification","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"_lotNumber","type":"string"},{"indexed":false,"internalType":"string","name":"_owner","type":"string"}],"name":"seedCreation","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"string","name":"SampleSecretCode","type":"string"},{"indexed":true,"internalType":"string","name":"SamplePassed","type":"string"}],"name":"seedTesting","type":"event"},{"inputs":[{"internalType":"string","name":"_lotNumber","type":"string"},{"internalType":"string","name":"_sampleSecretCode","type":"string"},{"internalType":"string","name":"_certificateNo","type":"string"},{"internalType":"string","name":"_certificateDate","type":"string"}],"name":"certify","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_lotNumber","type":"string"},{"internalType":"string","name":"_owner","type":"string"}],"name":"createSeed","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_lotNumber","type":"string"},{"internalType":"string","name":"_samplePassed","type":"string"},{"internalType":"string","name":"_sampleSecretCode","type":"string"}],"name":"testify","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_lotNumber","type":"string"}],"name":"queryCertify","outputs":[{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_lotNumber","type":"string"}],"name":"queryOwner","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_lotNumber","type":"string"}],"name":"queryTest","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"seeds","outputs":[{"internalType":"string","name":"LotNumber","type":"string"},{"internalType":"string","name":"owner","type":"string"},{"internalType":"string","name":"SampleSecretCode","type":"string"},{"internalType":"string","name":"SamplePassed","type":"string"},{"internalType":"string","name":"CertificateNo","type":"string"},{"internalType":"string","name":"CerticateDate","type":"string"},{"internalType":"bool","name":"exists","type":"bool"}],"stateMutability":"view","type":"function"}]')

bytecode= "608060405234801561001057600080fd5b506123bf806100206000396000f3fe608060405234801561001057600080fd5b506004361061007d5760003560e01c80636b6f54061161005b5780636b6f5406146106b1578063b7dc4b1014610784578063e9edc683146108d6578063f34cd64f14610ad75761007d565b80630d6f7e9c146100825780631b733d24146103dd5780636a8016e91461057d575b600080fd5b61013b6004803603602081101561009857600080fd5b81019080803590602001906401000000008111156100b557600080fd5b8201836020820111156100c757600080fd5b803590602001918460018302840111640100000000831117156100e957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610d57565b604051808060200180602001806020018060200180602001806020018815151515815260200187810387528e818151815260200191508051906020019080838360005b8381101561019957808201518184015260208101905061017e565b50505050905090810190601f1680156101c65780820380516001836020036101000a031916815260200191505b5087810386528d818151815260200191508051906020019080838360005b838110156101ff5780820151818401526020810190506101e4565b50505050905090810190601f16801561022c5780820380516001836020036101000a031916815260200191505b5087810385528c818151815260200191508051906020019080838360005b8381101561026557808201518184015260208101905061024a565b50505050905090810190601f1680156102925780820380516001836020036101000a031916815260200191505b5087810384528b818151815260200191508051906020019080838360005b838110156102cb5780820151818401526020810190506102b0565b50505050905090810190601f1680156102f85780820380516001836020036101000a031916815260200191505b5087810383528a818151815260200191508051906020019080838360005b83811015610331578082015181840152602081019050610316565b50505050905090810190601f16801561035e5780820380516001836020036101000a031916815260200191505b50878103825289818151815260200191508051906020019080838360005b8381101561039757808201518184015260208101905061037c565b50505050905090810190601f1680156103c45780820380516001836020036101000a031916815260200191505b509d505050505050505050505050505060405180910390f35b610496600480360360208110156103f357600080fd5b810190808035906020019064010000000081111561041057600080fd5b82018360208201111561042257600080fd5b8035906020019184600183028401116401000000008311171561044457600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929050505061114c565b604051808060200180602001838103835285818151815260200191508051906020019080838360005b838110156104da5780820151818401526020810190506104bf565b50505050905090810190601f1680156105075780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b83811015610540578082015181840152602081019050610525565b50505050905090810190601f16801561056d5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390f35b6106366004803603602081101561059357600080fd5b81019080803590602001906401000000008111156105b057600080fd5b8201836020820111156105c257600080fd5b803590602001918460018302840111640100000000831117156105e457600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929050505061145b565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561067657808201518184015260208101905061065b565b50505050905090810190601f1680156106a35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61076a600480360360208110156106c757600080fd5b81019080803590602001906401000000008111156106e457600080fd5b8201836020820111156106f657600080fd5b8035906020019184600183028401116401000000008311171561071857600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929050505061165c565b604051808215151515815260200191505060405180910390f35b6108d46004803603604081101561079a57600080fd5b81019080803590602001906401000000008111156107b757600080fd5b8201836020820111156107c957600080fd5b803590602001918460018302840111640100000000831117156107eb57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561084e57600080fd5b82018360208201111561086057600080fd5b8035906020019184600183028401116401000000008311171561088257600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929050505061187b565b005b610abd600480360360608110156108ec57600080fd5b810190808035906020019064010000000081111561090957600080fd5b82018360208201111561091b57600080fd5b8035906020019184600183028401116401000000008311171561093d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290803590602001906401000000008111156109a057600080fd5b8201836020820111156109b257600080fd5b803590602001918460018302840111640100000000831117156109d457600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610a3757600080fd5b820183602082011115610a4957600080fd5b80359060200191846001830284011164010000000083111715610a6b57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611cbf565b604051808215151515815260200191505060405180910390f35b610d5560048036036080811015610aed57600080fd5b8101908080359060200190640100000000811115610b0a57600080fd5b820183602082011115610b1c57600080fd5b80359060200191846001830284011164010000000083111715610b3e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610ba157600080fd5b820183602082011115610bb357600080fd5b80359060200191846001830284011164010000000083111715610bd557600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610c3857600080fd5b820183602082011115610c4a57600080fd5b80359060200191846001830284011164010000000083111715610c6c57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190640100000000811115610ccf57600080fd5b820183602082011115610ce157600080fd5b80359060200191846001830284011164010000000083111715610d0357600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611f2c565b005b600081805160208101820180518482526020830160208501208183528095505050505050600091509050806000018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610e195780601f10610dee57610100808354040283529160200191610e19565b820191906000526020600020905b815481529060010190602001808311610dfc57829003601f168201915b505050505090806001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610eb75780601f10610e8c57610100808354040283529160200191610eb7565b820191906000526020600020905b815481529060010190602001808311610e9a57829003601f168201915b505050505090806002018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610f555780601f10610f2a57610100808354040283529160200191610f55565b820191906000526020600020905b815481529060010190602001808311610f3857829003601f168201915b505050505090806003018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610ff35780601f10610fc857610100808354040283529160200191610ff3565b820191906000526020600020905b815481529060010190602001808311610fd657829003601f168201915b505050505090806004018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156110915780601f1061106657610100808354040283529160200191611091565b820191906000526020600020905b81548152906001019060200180831161107457829003601f168201915b505050505090806005018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561112f5780601f106111045761010080835404028352916020019161112f565b820191906000526020600020905b81548152906001019060200180831161111257829003601f168201915b5050505050908060060160009054906101000a900460ff16905087565b606080600115156000846040518082805190602001908083835b602083106111895780518252602082019150602081019050602083039250611166565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060060160009054906101000a900460ff16151514611242576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f5365656420776173206e6f74206372656174656400000000000000000000000081525060200191505060405180910390fd5b6000836040518082805190602001908083835b602083106112785780518252602082019150602081019050602083039250611255565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390206004016000846040518082805190602001908083835b602083106112e457805182526020820191506020810190506020830392506112c1565b6001836020036101000a0380198251168184511680821785525050505050509050019150509081526020016040518091039020600501818054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156113af5780601f10611384576101008083540402835291602001916113af565b820191906000526020600020905b81548152906001019060200180831161139257829003601f168201915b50505050509150808054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561144b5780601f106114205761010080835404028352916020019161144b565b820191906000526020600020905b81548152906001019060200180831161142e57829003601f168201915b5050505050905091509150915091565b6060600115156000836040518082805190602001908083835b602083106114975780518252602082019150602081019050602083039250611474565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060060160009054906101000a900460ff16151514611550576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f5365656420776173206e6f74206372656174656400000000000000000000000081525060200191505060405180910390fd5b6000826040518082805190602001908083835b602083106115865780518252602082019150602081019050602083039250611563565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390206001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156116505780601f1061162557610100808354040283529160200191611650565b820191906000526020600020905b81548152906001019060200180831161163357829003601f168201915b50505050509050919050565b6000600115156000836040518082805190602001908083835b602083106116985780518252602082019150602081019050602083039250611675565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060060160009054906101000a900460ff16151514611751576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f5365656420776173206e6f74206372656174656400000000000000000000000081525060200191505060405180910390fd5b6040518060400160405280600381526020017f5965730000000000000000000000000000000000000000000000000000000000815250805190602001206000836040518082805190602001908083835b602083106117c457805182526020820191506020810190506020830392506117a1565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060030160405180828054600181600116156101000203166002900480156118555780601f10611833576101008083540402835291820191611855565b820191906000526020600020905b815481529060010190602001808311611841575b5050915050604051809103902014156118715760019050611876565b600090505b919050565b600015156000836040518082805190602001908083835b602083106118b55780518252602082019150602081019050602083039250611892565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060060160009054906101000a900460ff1615151461196e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f536565642077617320616c72656164792072656769737465726564000000000081525060200191505060405180910390fd5b6119766122a5565b6040518060e001604052808481526020018381526020016040518060400160405280600181526020017f300000000000000000000000000000000000000000000000000000000000000081525081526020016040518060400160405280600181526020017f300000000000000000000000000000000000000000000000000000000000000081525081526020016040518060400160405280600181526020017f300000000000000000000000000000000000000000000000000000000000000081525081526020016040518060400160405280600181526020017f30000000000000000000000000000000000000000000000000000000000000008152508152602001600115158152509050806000846040518082805190602001908083835b60208310611ab95780518252602082019150602081019050602083039250611a96565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390206000820151816000019080519060200190611b089291906122e4565b506020820151816001019080519060200190611b259291906122e4565b506040820151816002019080519060200190611b429291906122e4565b506060820151816003019080519060200190611b5f9291906122e4565b506080820151816004019080519060200190611b7c9291906122e4565b5060a0820151816005019080519060200190611b999291906122e4565b5060c08201518160060160006101000a81548160ff021916908315150217905550905050826040518082805190602001908083835b60208310611bf15780518252602082019150602081019050602083039250611bce565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390207f08cc2579e83b83cda43427eee468067817db890bb387401c945806df1741cd32836040518080602001828103825283818151815260200191508051906020019080838360005b83811015611c80578082015181840152602081019050611c65565b50505050905090810190601f168015611cad5780820380516001836020036101000a031916815260200191505b509250505060405180910390a2505050565b6000600115156000856040518082805190602001908083835b60208310611cfb5780518252602082019150602081019050602083039250611cd8565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060060160009054906101000a900460ff16151514611db4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f5365656420776173206e6f74206372656174656400000000000000000000000081525060200191505060405180910390fd5b826000856040518082805190602001908083835b60208310611deb5780518252602082019150602081019050602083039250611dc8565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390206003019080519060200190611e349291906122e4565b5081805190602001206000856040518082805190602001908083835b60208310611e735780518252602082019150602081019050602083039250611e50565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390206002016040518082805460018160011615610100020316600290048015611f045780601f10611ee2576101008083540402835291820191611f04565b820191906000526020600020905b815481529060010190602001808311611ef0575b505091505060405180910390201415611f205760019050611f25565b600090505b9392505050565b600115156000856040518082805190602001908083835b60208310611f665780518252602082019150602081019050602083039250611f43565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060060160009054906101000a900460ff1615151461201f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f5365656420776173206e6f74206372656174656400000000000000000000000081525060200191505060405180910390fd5b826000856040518082805190602001908083835b602083106120565780518252602082019150602081019050602083039250612033565b6001836020036101000a0380198251168184511680821785525050505050509050019150509081526020016040518091039020600201908051906020019061209f9291906122e4565b50816000856040518082805190602001908083835b602083106120d757805182526020820191506020810190506020830392506120b4565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060040190805190602001906121209291906122e4565b50806000856040518082805190602001908083835b602083106121585780518252602082019150602081019050602083039250612135565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060050190805190602001906121a19291906122e4565b50816040518082805190602001908083835b602083106121d657805182526020820191506020810190506020830392506121b3565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390207fdf0dfac0952a85405f5c94b7f8cf9d416a3973650d83adc41d3797dca9542f16826040518080602001828103825283818151815260200191508051906020019080838360005b8381101561226557808201518184015260208101905061224a565b50505050905090810190601f1680156122925780820380516001836020036101000a031916815260200191505b509250505060405180910390a250505050565b6040518060e001604052806060815260200160608152602001606081526020016060815260200160608152602001606081526020016000151581525090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061232557805160ff1916838001178555612353565b82800160010185558215612353579182015b82811115612352578251825591602001919060010190612337565b5b5090506123609190612364565b5090565b61238691905b8082111561238257600081600090555060010161236a565b5090565b9056fea264697066735822122055a5047700a7a6c9e327dbce81ec0af85ddb5fa7eb96f42d02a24390cf5b48b364736f6c63430006060033"

private_key = 'a1dd85b68f449a7acbed0f91d9cc586b7b943a9d057ddf6f5327f13204f69e64'


# set pre-funded account as sender
web3.eth.defaultAccount = '0x9aa49368F973F32a1d8E9C8D9F58fd203C625BEe'
print(web3.isConnected())
print(web3.eth.blockNumber)
#print(web3.eth.defaultAccount.getBalance())
# Instantiate and deploy contract
productManager = web3.eth.contract(abi=abi, bytecode=bytecode)

# # Submit the transaction that deploys the contract
transaction =  productManager.constructor().buildTransaction()
transaction.update({ 'gas' : 12499988 })
transaction.update({ 'nonce' : web3.eth.getTransactionCount('0x9aa49368F973F32a1d8E9C8D9F58fd203C625BEe') })
signed_tx = web3.eth.account.signTransaction(transaction, private_key)
txn_hash = web3.eth.sendRawTransaction(signed_tx.rawTransaction)
receipt = web3.eth.waitForTransactionReceipt(txn_hash)
# # Wait for the transaction to be mined, and get the transaction receipt
print(receipt.contractAddress)
